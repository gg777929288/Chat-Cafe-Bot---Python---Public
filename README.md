# 聊天咖啡廳 Discord 機器人

歡迎加入我們的 Discord 伺服器：[聊天咖啡廳](https://discord.gg/VzdeVzHfxB)！也歡迎參訪我們的網站：[咖啡廳網站](https://www.coffeeshoptw.com/)。

這是一個使用 `discord.py` 庫製作的 Discord 機器人。該機器人可以加載位於 `./cogs` 目錄中的擴展（Cogs），並且在啟動時同步應用指令樹。本程式碼使用 GitHub Copilot 等 AI 工具進行產生，也開放各位使用及修改。

## 主要功能

- 使用 `discord.py` 庫來建立機器人。
- 支援指令前綴 `!`。
- 自動加載 `./cogs` 目錄中的所有擴展。
- 在啟動時同步應用指令樹。
- 每個檔案項目目前皆為獨立運行，`main.py` 為集成 Discord 斜線指令功能之檔案，其餘為專用功能之檔案。

## 功能與指令介紹

### 公告功能
- **指令**: `!公告 <內容>`
- **說明**: 發布公告到指定頻道。
- **權限**: 需要管理員權限。

## 功能與指令介紹

### 公告功能
- **指令**: `/公告 <內容>`
- **說明**: 發布公告到指定頻道。
- **權限**: 需要管理員權限。

### 帳號管理功能
- **指令**: `/創建帳號`
- **說明**: 創建一個新的用戶帳號。
- **指令**: `/登入 <帳號或電子郵件> <密碼>`
- **說明**: 登入到您的帳號。

### 使用者資訊功能
- **指令**: `/使用者`
- **說明**: 查看您的個人資料。
- **指令**: `/搜尋使用者 <用戶名>`
- **說明**: 搜尋伺服器中的用戶。

### 語音頻道管理功能
- **指令**: `/管理語音頻道`
- **說明**: 管理您當前的語音頻道。
- **指令**: `/set_channel_name <名稱>`
- **說明**: 設置您當前語音頻道的名稱。
- **指令**: `/set_channel_region <區域>`
- **說明**: 設置您當前語音頻道的區域。
- **指令**: `/mute_user @用戶`
- **說明**: 將指定用戶靜音。
- **指令**: `/deafen_user @用戶`
- **說明**: 將指定用戶禁聲。
- **指令**: `/blacklist_user @用戶`
- **說明**: 將指定用戶列入黑名單。
- **指令**: `/invite_manager @用戶`
- **說明**: 邀請指定用戶為管理員。

### 檢舉系統功能
- **指令**: `/檢舉紀錄 @用戶`
- **說明**: 查詢指定用戶的檢舉紀錄。
- **指令**: `/被檢舉紀錄 @用戶`
- **說明**: 查詢指定用戶的被檢舉紀錄。
- **指令**: `/檢舉案件 [搜尋條件]`
- **說明**: 查詢符合條件的檢舉案件。
- **指令**: `/指令`
- **說明**: 查看機器人的指令列表。
- **指令**: `@機器人 我要檢舉 (可@該用戶)`
- **說明**: 檢舉其他人違規的行為。

### 機器人管理功能
- **指令**: `/start_bot`
- **說明**: 啟動機器人。
- **指令**: `/stop_bot`
- **說明**: 停止機器人。

### 錯誤處理功能
- **說明**: 自動處理機器人運行過程中的錯誤並嘗試重連。

### 檔案介紹

以下是各個檔案的用途、關聯及其中代碼的用意：

#### `README.md`
- **用途**: 提供專案的基本介紹、功能說明、指令介紹以及運行指南。
- **關聯**: 包含對所有檔案和功能的總覽，並指導使用者如何運行機器人。
- **代碼用途**: 詳細列出如何安裝所需的庫、設定機器人 Token 及運行機器人的步驟。

#### `web/app.py`
- **用途**: 設定 Flask 應用，提供網頁介面和 API 端點。
- **關聯**: 與 Discord 機器人協同工作，提供語音頻道管理和用戶管理等功能。
- **代碼用途**: 包含 Flask 應用初始化、路由設定、管理員功能和錯誤處理等。

#### `bot.py`
- **用途**: Discord 機器人的主檔案，負責機器人的初始化和啟動。
- **關聯**: 加載各個 Cogs，處理 Discord 事件和指令。
- **代碼用途**: 包含機器人的初始化、事件處理和指令處理邏輯。

#### `web/templates/*.html`
- **用途**: 提供 Flask 應用的 HTML 模板文件，構建管理介面和用戶界面。
- **關聯**: 與 `web/app.py` 關聯，提供網頁顯示功能。
- **代碼用途**: 包含 HTML 結構和樣式設定，實現各種管理和顯示功能。

#### `cogs/*.py`
- **用途**: 各種功能模塊的實現文件，分別處理不同的機器人功能。
- **關聯**: 被 `bot.py` 加載，提供具體的功能實現。
- **代碼用途**: 每個文件實現不同的功能，如公告、用戶信息、語音頻道管理等。

#### `config.py`
- **用途**: 配置文件，儲存機器人的各種配置信息。
- **關聯**: 被 `bot.py` 和 `web/app.py` 使用，提供配置信息。
- **代碼用途**: 包含 Discord Token、資料庫路徑、OAuth2 設定等。

#### `shared_config.py`
- **用途**: 提供共享設定，包含 Flask 和 Discord 機器人的初始化和配置。
- **關聯**: 與 `config.py`、`bot.py` 和 `web/app.py` 關聯，提供共享變數和函數。
- **代碼用途**: 包含初始化函數和共享變數，實現 Flask 和 Discord 機器人的協同工作。

#### `web/static/*`
- **用途**: 靜態資源文件，包含 CSS 和 JS 文件，提供網頁樣式和行為。
- **關聯**: 被 `web/templates/*.html` 使用，提供樣式和互動功能。
- **代碼用途**: 包含樣式定義和 JavaScript 代碼，實現網頁的外觀和行為。

#### `help_cog.py`
- **用途**: 提供機器人的指令幫助功能，顯示所有可用的機器人指令。
- **關聯**: 被 `bot.py` 加載，提供指令幫助功能。
- **代碼用途**: 包含一個指令，顯示機器人的所有可用指令及其說明。

這些檔案共同構建了聊天咖啡廳 Discord 機器人的完整功能，從網頁管理介面到 Discord 機器人指令，涵蓋了多種用戶需求。

## 如何運行？

1. 安裝所需的庫（比如 Discord.py，後續需要什麼功能可以自己再下載）：
    ```bash
    pip install discord.py
    pip install flask
    pip install websockets
    pip install aiosqlite
    pip install flask-cors
    pip install asyncio
    pip install flask-socketio
    pip install requests
    ```

2. 到 [Discord Developer Portal](https://discord.com/developers/applications) 取得你的機器人 Token，並將你的機器人 Token 替換到所有檔案中的 `YOUR_BOT_TOKEN` 字樣。

3. 若只要運行機器人，請先確認完所有代碼後運行機器人：
    ```bash
    python bot.py
    ```
4. 若要先運行網頁，請先至"web"資料夾，然後運行：
    ```bash
    python app.py
    ```

## 如何聯絡我們？
   若有問題的話歡迎加入我們的[Discord](https://discord.gg/liao-tian-noka-pei-ting-541557358048837654)與我們聯絡！
